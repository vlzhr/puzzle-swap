(this["webpackJsonpproject-123"]=this["webpackJsonpproject-123"]||[]).push([[0],{138:function(t,e,n){},139:function(t,e,n){},250:function(t,e,n){"use strict";n.r(e);var a=n(4),s=n.n(a),i=n(35),c=n.n(i),o=(n(138),n(139),n(29)),r=n.n(o),u=n(58),l=n(13),d=n(17),h=n(38),j=n(36),p=n(118),m=n.n(p),g=n(11),v=n.n(g),O=n(37),f=n(255),b=n(252),x=n(253),k=n(254),w=(n(157),n(158),n(74)),S=n(133),_=n(132),y=new function t(){Object(l.a)(this,t),this.signer=void 0,this.signer=new w.Signer({NODE_URL:"https://nodes.wavesnodes.com"}),this.signer.setProvider(new S.a("https://waves.exchange/signer/"))},N=new function t(){Object(l.a)(this,t),this.signer=void 0,this.signer=new w.Signer,this.signer.setProvider(new _.a)},C=n(47),I=n.n(C),E=n(5);var P=function(t){var e=t.txData,n=Object(a.useState)(!1),s=Object(O.a)(n,2),i=s[0],c=s[1],o=function(){return c(!i)};return Object(E.jsxs)("div",{children:[Object(E.jsx)("button",{onClick:o,children:"Exchange"}),Object(E.jsxs)(f.a,{isOpen:i,toggle:o,className:"modal-window mt-5",children:[Object(E.jsx)(b.a,{toggle:o,children:"Authorize with your Waves wallet"}),Object(E.jsxs)(x.a,{className:"text-center",children:[Object(E.jsx)("div",{children:Object(E.jsx)(k.a,{className:"mt-4 mb-2",color:"success",size:"lg",onClick:function(){return N.signer.login()},children:"Waves Exchange Email"})}),Object(E.jsx)("div",{children:Object(E.jsx)(k.a,{className:"mb-2",color:"success",size:"lg",onClick:function(){return y.signer.login()},children:"Waves Exchange Seed"})}),Object(E.jsx)("div",{children:Object(E.jsx)(k.a,{className:"mb-5",color:"success",size:"lg",onClick:function(){return function(t){return window.WavesKeeper.signAndPublishTransaction({type:16,data:{fee:{tokens:"0.05",assetId:"WAVES"},dApp:F,call:{function:"swap",args:[{type:"string",value:t.tokenOut},{type:"integer",value:0}]},payment:[t.pmt]}}).then((function(t){C.store.addNotification({title:"Congratulations!",message:"You successfully performed an exchange.",type:"success",insert:"top",container:"top-right",animationIn:["animate__animated","animate__fadeIn"],animationOut:["animate__animated","animate__fadeOut"],dismiss:{duration:5e3,onScreen:!0}}),console.log(t)})).catch((function(t){C.store.addNotification({title:"Error while completing exchange!",message:JSON.stringify(t),type:"danger",insert:"top",container:"top-right",animationIn:["animate__animated","animate__fadeIn"],animationOut:["animate__animated","animate__fadeOut"],dismiss:{duration:5e3,onScreen:!0}}),console.log(t)}))}(e).then(o)},children:"Waves Keeper"})})]})]})]})},T=function(t){Object(h.a)(n,t);var e=Object(j.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).state={data:new Map,tokenOut:0,amountIn:0},a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=Object(u.a)(r.a.mark((function t(){var e=this;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:setInterval(Object(u.a)(r.a.mark((function t(){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.downloadState();case 2:n=t.sent,e.setState({data:n});case 4:case"end":return t.stop()}}),t)}))),1e3);case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"downloadState",value:function(){var t=Object(u.a)(r.a.mark((function t(){var e,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.get("".concat("https://wavesducks.wavesnodes.com","/addresses/data/3PL3TvgimsLFWs3xW4kpVmvRf3c8HX7JMS7"));case 2:return e=t.sent.data,n=new Map,e.forEach((function(t){n.set(t.key,t.value)})),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"calculateCurrentPrice",value:function(t,e){return Math.round(this.state.data.get("global_"+[M[t]]+"_balance")/.5/z[t]*1e4/(this.state.data.get("global_"+[M[e]]+"_balance")/.5/z[e]))/1e4}},{key:"calculateAmountOut",value:function(){var t=this.state.tokenOut,e=0===this.state.tokenOut?1:0,n=this.state.data.get("global_"+[M[e]]+"_balance"),a=this.state.data.get("global_"+[M[t]]+"_balance")/z[t]*(1-Math.pow(n/(n+z[e]*this.state.amountIn),D[e]/D[t]));return Math.round(a*z[t])/z[t]}},{key:"getTokenIn",value:function(){return 0===this.state.tokenOut?1:0}},{key:"handleInput",value:function(t){var e=parseFloat(t.target.value),n=isNaN(e)?0:e;this.setState({amountIn:n})}},{key:"render",value:function(){var t=this;return Object(E.jsxs)("div",{className:"swap-window",children:[Object(E.jsxs)("div",{className:"choose",children:[Object(E.jsxs)("div",{className:v()("choose-option",{chosen:0===this.state.tokenOut}),onClick:function(){return t.setState({tokenOut:0})},children:["USDN to STREET: ",this.calculateCurrentPrice(0,1)]}),Object(E.jsxs)("div",{className:v()("choose-option",{chosen:1===this.state.tokenOut}),onClick:function(){return t.setState({tokenOut:1})},children:["STREET to USDN: ",this.calculateCurrentPrice(1,0)]})]}),Object(E.jsxs)("div",{children:[Object(E.jsx)("input",{onChange:function(e){return t.handleInput(e)},type:"text",placeholder:W[this.getTokenIn()]+" amount"}),Object(E.jsxs)("div",{children:["You will receive ",this.calculateAmountOut()," ",W[this.state.tokenOut]]}),Object(E.jsx)(P,{txData:{pmt:{assetId:M[this.getTokenIn()],tokens:this.state.amountIn},tokenOut:M[this.state.tokenOut]}})]})]})}}]),n}(s.a.Component),M=["CE5cxMvz7865CyFZPFUmDiL4KRkYXP6b6oYgN3vmWdV5","DG2xFkPdDwKUoBkzGAhQtLpSGzfXLiCYPEzeKH2Ad24p"],W=["STREET","USDN"],D=[.5,.5],z=[Math.pow(10,8),Math.pow(10,6)],F="3PL3TvgimsLFWs3xW4kpVmvRf3c8HX7JMS7";var L=function(){return Object(E.jsxs)("div",{className:"App",children:[Object(E.jsx)("header",{children:Object(E.jsxs)("div",{children:[Object(E.jsx)("span",{className:"logo",children:"\ud83e\udde9"}),"\xa0\xa0",Object(E.jsx)("span",{children:"Puzzle Swap"})]})}),Object(E.jsx)(I.a,{className:"notificationWindow"}),Object(E.jsx)(T,{})]})},A=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,256)).then((function(e){var n=e.getCLS,a=e.getFID,s=e.getFCP,i=e.getLCP,c=e.getTTFB;n(t),a(t),s(t),i(t),c(t)}))};c.a.render(Object(E.jsx)(s.a.StrictMode,{children:Object(E.jsx)(L,{})}),document.getElementById("root")),A()},64:function(t,e){}},[[250,1,2]]]);
//# sourceMappingURL=main.35492e7d.chunk.js.map